<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Privacy Shield</title>
  <style>
    :root{
      --bg:#0f1321;
      --card:#151a2e;
      --muted:#9aa4b2;
      --text:#e8ecf3;
      --accent:#6f7cff;
      --success:#36c275;
      --border:#232845;
      --radius:14px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font:14px/1.35 system-ui,Segoe UI,Roboto,Arial}
    a{color:#8fb3ff;text-decoration:none}
    .wrap{width:340px; padding:14px}
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:0 10px 24px rgba(0,0,0,.35)
    }

    /* HEADER ‚Äî stacked layout */
    .header{
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      gap:8px;
      padding:16px;
    }
    #current-url{
      font-weight:600;
      font-size:15px;
      max-width:100%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .status-text{
      font-size:13px;
      color:var(--muted);
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-size:13px;
      padding:4px 10px;
      border-radius:999px;
      background:#0e1a36;
      color:#4effb6;
      border:1px solid #133b29;
      white-space:nowrap;
    }

    /* Shields row */
    .shield-row{
      width:100%;
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-top:2px;
    }
    .shield-label{
      font-weight:600;
      font-size:14px;
    }
    .toggle{
      position:relative;
      width:52px;height:28px;border-radius:999px;
      background:#2b3154;cursor:pointer;transition:.2s
    }
    .toggle input{appearance:none;width:0;height:0;opacity:0;position:absolute}
    .knob{position:absolute;top:3px;left:3px;width:22px;height:22px;border-radius:50%;background:#fff;transition:.2s}
    .toggle.on{background:var(--accent)}
    .toggle.on .knob{left:27px}

    .sub{color:var(--muted);font-size:12px;padding:0 16px 12px}
    .sep{height:1px;background:var(--border);margin:8px 0}

    /* Controls */
    .section{padding:10px 16px}
    .row{display:flex;align-items:center;justify-content:space-between;margin:10px 0}
    .label{color:#dfe4ee}
    select,.switch{
      background:#0f1637;color:#dfe4ee;border:1px solid var(--border);
      border-radius:10px;padding:8px 10px
    }
    select{min-width:140px}
    .switch{display:flex;align-items:center;gap:8px;padding:6px 10px;cursor:pointer}
    .switch input{accent-color:var(--accent)}

.accordion { border-top:1px solid var(--border); }
.accordion > summary { list-style:none; }             /* hide default marker */
.accordion > summary::-webkit-details-marker{display:none}

.acc-head{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;cursor:pointer}
.chev{transform:rotate(0deg);transition:.2s}

.accordion .acc-body{display:none}
.accordion[open] .acc-body{display:block}            /* shown when open */
.accordion[open] .chev{transform:rotate(90deg)}      /* rotate arrow */



    /* Footer */
    .footer{display:flex;justify-content:space-between;padding:12px 16px;font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">

      <!-- Header (stacked) -->
      <div class="header">
        <div id="current-url">loading‚Ä¶</div>

        <div id="status-text" class="status-text">
          Not protected by GBC Shields 1.0
        </div>

        <div class="pill" id="shield-badge">üõ°Ô∏è Privacy Shield is ACTIVE</div>

        <div class="shield-row">
          <span class="shield-label" id="shield-label">Shields are UP</span>
          <div class="toggle on" id="shield-toggle">
            <input type="checkbox" checked>
            <div class="knob"></div>
          </div>
        </div>
      </div>

      <div class="sub">If this site seems broken, try Shields down. Note: this may reduce Privacy Shield protections.</div>

        <div class="sep"></div>
          <!-- Blocked counters -->
          <div class="section" id="blocked-metrics" style="padding-top:0;">
            <div class="metrics" style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:8px;">

              <div class="metric" style="background:#0f1637;border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center;">
                <div id="count-ads-trackers" style="font-weight:700;font-size:20px;line-height:1.2;margin-bottom:4px;">0</div>
                <div style="font-size:12px;color:#9aa4b2;">Ads & Trackers</div>
              </div>

              <div class="metric" style="background:#0f1637;border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center;">
                <div id="count-fp" style="font-weight:700;font-size:20px;line-height:1.2;margin-bottom:4px;">0</div>
                <div style="font-size:12px;color:#9aa4b2;">Fingerprinting</div>
              </div>

              <div class="metric" style="background:#0f1637;border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center;">
                <div id="count-scripts-cookies" style="font-weight:700;font-size:20px;line-height:1.2;margin-bottom:4px;">0</div>
                <div style="font-size:12px;color:#9aa4b2;">Scripts & Cookies</div>
              </div>

              <div class="metric" style="background:#0f1637;border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center;">
                <div id="count-phish" style="font-weight:700;font-size:20px;line-height:1.2;margin-bottom:4px;">0</div>
                <div style="font-size:12px;color:#9aa4b2;">Phishing</div>
              </div>

            </div>
          </div>

      <!-- Quick Controls -->
      <div class="section">
        <div class="row"><div class="label">Block trackers & ads</div>
          <select id="ad-block">
            <option value="enabled">Enabled</option>
            <option value="disabled">Disabled</option>
          </select>
        </div>

        <div class="row"><div class="label">Upgrade connections to HTTPS</div>
          <select id="https">
            <option value="enabled">Enabled</option>
            <option value="disabled">Disabled</option>
          </select>
        </div>

        <div class="row">
          <div class="label">
            Block scripts
          </div>
          <label class="switch">
            <input type="checkbox" id="block-scripts" checked>
            <span>On</span>
          </label>
        </div>
        <div class="row"><div class="label">Block fingerprinting</div>
          <label class="switch"><input type="checkbox" id="fingerprint"><span>On</span></label>
        </div>

        <div class="row"><div class="label">Block third-party cookies</div>
          <select id="cookies">
            <option value="enabled">Enabled</option>
            <option value="disabled">Disabled</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- Your existing popup logic (storage, hostname, etc.) -->
  <script src="popup.js"></script>

  <!-- Master toggle + status text behaviour -->
  <script>
    const shield = document.getElementById('shield-toggle');
    const statusText = document.getElementById('status-text');
    const shieldLabel = document.getElementById('shield-label');

    function applyMaster(isOn){
      // Text lines
      statusText.textContent = isOn
        ? 'Your browsing experience is protected.'
        : 'Not protected by GBC Shields 1.0';
      shieldLabel.textContent = isOn ? 'Shields are UP' : 'Shields are DOWN';

      // Enable/disable controls
      const controls = '#ad-block, #phishing, #https, #cookies, #block-scripts, #fingerprint, #forget-site, #mlEnabled';
      document.querySelectorAll(controls).forEach(el => { el.disabled = !isOn; });
    }

    // Load master state
    chrome?.storage?.local?.get?.(['shield_master'], d => {
      const isOn = d?.shield_master ?? true;
      if (!isOn) shield.classList.remove('on');
      shield.querySelector('input').checked = isOn;
      applyMaster(isOn);
    });

    // Click handler
    shield.addEventListener('click', () => {
      shield.classList.toggle('on');
      const isOn = shield.classList.contains('on');
      shield.querySelector('input').checked = isOn;
      chrome?.storage?.local?.set?.({ shield_master: isOn });
      applyMaster(isOn);
    });

    // Simple accordion (optional)
    const head = document.getElementById('acc-head');
    const body = document.getElementById('acc-body');
    head.addEventListener('click', () => {
      head.parentElement.classList.toggle('open');
    });
  </script>
</body>
</html>
